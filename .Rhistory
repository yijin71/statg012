# prior p(mu,tau)
z <- stats::qgamma(0.9999, shape = alpha, rate = beta)
tau <- seq(0,z, length.out = 1000)
tau.prior <- stats::dgamma(tau, shape = alpha, rate = beta)
muu <- m + 4
mul <- m - 4
mu <- seq(mul, muu, length.out = 1000)
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
prior <- tau ^ (alpha - 0.5) * exp(- beta * tau) *
exp(-0.5 * tau * p * (mu - m) ^ 2)
######################################################################
#likelihood x~N(mu, tao^-1)
n <- length(x)
#x <- rnorm(n, mean = m,  sd = sqrt(1/p*tau))
x_mean <- mean(x)
s_var <- 1 / n * sum((x - x_mean) ^ 2)
ss <- n * s_var
likelihood <- tau ^ (n / 2) * exp((-tau/2) *
(n * s_var + n * (x_mean-mu) ^2))
######################################################################
#posterior
pos.p <- p + n
pos.m <- (p * m + n * x_mean) / pos.p
pos.alpha <- alpha + n/2
pos.beta <- beta + 0.5 * (ss + (p * n * (x_mean - m)^2 /pos.p))
pos1 <- pos.alpha - 0.5
pos2 <- tau * pos.p * 0.5 * (mu - pos.m) ^ 2
pos3 <- tau * (beta + ss * 0.5)
pos4 <- 0.5 * tau * (p * (m ^ 2) + n * (x_mean ^2) + pos.p * (pos.m ^ 2))
tau.posterior <- stats::dgamma(tau, pos.alpha, pos.beta)
posterior <- tau ^ pos1 * exp(-pos2) * exp(-pos3) * exp(-pos4)
res <- list( mu = mu,
tau = tau,
prior = prior,
mu.prior = mu.prior,
tau.prior = tau.prior,
likelihood = likelihood,
posterior = posterior,
pos.m =  pos.m,
pos.p =  pos.p,
pos.alpha = pos.alpha,
pos.beta = pos.beta,
m = m,
p = p,
xmean = x_mean,
ss =ss)
cat(paste("Posterior mu0      : ", round(pos.m,4),"\n",sep=""))
cat(paste("Posterior lamda0   : ", round(pos.p,4),"\n",sep=""))
cat(paste("Posterior alpha    : ", round(pos.alpha,4),"\n",sep=""))
cat(paste("Posterior beta     : ", round(pos.beta,4),"\n",sep=""))
invisible(res)
}
a <- normalprob(y,m,p,alpha,beta)
a$ss
x- mean(x)
x <- rnorm(13, mean=1.998, sd = 6.297/13)
x- mean(x)
matplot(a$tau, cbind(a$tau, a$tau.prior)
)
matplot(cbind(a$tau,a$tau), cbind(a$tau, a$tau.prior),col=1:2)
phi = rgamma(10000, a$pos.alpha, a$pos.beta)
plot(1.5:4.5, phi)
r <- range(1.5:4.5)
r
r <- 1.5:4.5
r
r <- seq (1.5, 4.5, length.out = 10000)
plot(r, phi)
a$posterior
?rt
dt(a$mu, df = pos.alpha)
dt(a$mu, df = a$pos.alpha)
try <- dt(a$mu, df = a$pos.alpha)
m <- 2.773
p <- 25
alpha <- 12
beta <- 92.85
x <- rnorm(13, mean=1.998, sd = 6.297/13)
y <- x- mean(x) +1.998
normalprob <- function (x, m, p, alpha, beta){
######################################################################
# prior p(mu,tau)
z <- stats::qgamma(0.9999, shape = alpha, rate = beta)
tau <- seq(0,z, length.out = 1000)
tau.prior <- stats::dgamma(tau, shape = alpha, rate = beta)
muu <- m + 4
mul <- m - 4
mu <- seq(mul, muu, length.out = 1000)
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
prior <- tau ^ (alpha - 0.5) * exp(- beta * tau) *
exp(-0.5 * tau * p * (mu - m) ^ 2)
######################################################################
#likelihood x~N(mu, tao^-1)
n <- length(x)
x_mean <- mean(x)
s_var <- 1 / n * sum((x - x_mean) ^ 2)
ss <- n * s_var
likelihood <- tau ^ (n / 2) * exp((-tau/2) *
(n * s_var + n * (x_mean-mu) ^2))
######################################################################
#posterior
pos.p <- p + n
pos.m <- (p * m + n * x_mean) / pos.p
pos.alpha <- alpha + n/2
pos.beta <- beta + 0.5 * (ss + (p * n * (x_mean - m)^2 /pos.p))
tau.posterior <- stats::dgamma(tau, pos.alpha, pos.beta)
p1 <- (mu - pos.m) ^ 2
p2 <- pos.alpha + 0.5
mu.posterior1 <- (2 * pos.beta + pos.p * p2) ^ (-p1)
mu.posterior2 <- stats::dt(mu, df = 2 * pos.alpha)
pos1 <- pos.alpha - 0.5
pos2 <- tau * pos.p * 0.5 * (mu - pos.m) ^ 2
pos3 <- tau * (beta + ss * 0.5)
pos4 <- 0.5 * tau * (p * (m ^ 2) + n * (x_mean ^2) + pos.p * (pos.m ^ 2))
posterior <- tau ^ pos1 * exp(-pos2) * exp(-pos3) * exp(-pos4)
res <- list( mu = mu,
tau = tau,
prior = prior,
mu.prior = mu.prior,
tau.prior = tau.prior,
likelihood = likelihood,
posterior = posterior,
pos.m =  pos.m,
pos.p =  pos.p,
pos.alpha = pos.alpha,
pos.beta = pos.beta,
mu.posterior2 = mu.posterior2,
mu.posterior1 = mu.posterior1)
cat(paste("Posterior mu0      : ", round(pos.m,4),"\n",sep=""))
cat(paste("Posterior lamda0   : ", round(pos.p,4),"\n",sep=""))
cat(paste("Posterior alpha    : ", round(pos.alpha,4),"\n",sep=""))
cat(paste("Posterior beta     : ", round(pos.beta,4),"\n",sep=""))
invisible(res)
}
a <- normalprob(y,m,p,alpha,beta)
a$mu.posterior2
try2 <- a$mu.posterior2
matplot(cbind(a$mu, a$mu), cbind(a$mu.prior, a$mu.posterior2), col = 1:2)
contour(a$mu, a$tau, outer(a$mu.prior,a$tau.prior))
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior))
a$tau.posterior
normalprob <- function (x, m, p, alpha, beta){
######################################################################
# prior p(mu,tau)
z <- stats::qgamma(0.9999, shape = alpha, rate = beta)
tau <- seq(0,z, length.out = 1000)
tau.prior <- stats::dgamma(tau, shape = alpha, rate = beta)
muu <- m + 4
mul <- m - 4
mu <- seq(mul, muu, length.out = 1000)
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
prior <- tau ^ (alpha - 0.5) * exp(- beta * tau) *
exp(-0.5 * tau * p * (mu - m) ^ 2)
######################################################################
#likelihood x~N(mu, tao^-1)
n <- length(x)
x_mean <- mean(x)
s_var <- 1 / n * sum((x - x_mean) ^ 2)
ss <- n * s_var
likelihood <- tau ^ (n / 2) * exp((-tau/2) *
(n * s_var + n * (x_mean-mu) ^2))
######################################################################
#posterior
pos.p <- p + n
pos.m <- (p * m + n * x_mean) / pos.p
pos.alpha <- alpha + n/2
pos.beta <- beta + 0.5 * (ss + (p * n * (x_mean - m)^2 /pos.p))
tau.posterior <- stats::dgamma(tau, pos.alpha, pos.beta)
p1 <- (mu - pos.m) ^ 2
p2 <- pos.alpha + 0.5
mu.posterior1 <- (2 * pos.beta + pos.p * p2) ^ (-p1)
mu.posterior2 <- stats::dt(mu, df = 2 * pos.alpha)
pos1 <- pos.alpha - 0.5
pos2 <- tau * pos.p * 0.5 * (mu - pos.m) ^ 2
pos3 <- tau * (beta + ss * 0.5)
pos4 <- 0.5 * tau * (p * (m ^ 2) + n * (x_mean ^2) + pos.p * (pos.m ^ 2))
posterior <- tau ^ pos1 * exp(-pos2) * exp(-pos3) * exp(-pos4)
res <- list( mu = mu,
tau = tau,
prior = prior,
mu.prior = mu.prior,
tau.prior = tau.prior,
likelihood = likelihood,
posterior = posterior,
pos.m =  pos.m,
pos.p =  pos.p,
pos.alpha = pos.alpha,
pos.beta = pos.beta,
tau.posterior = tau.posterior,
mu.posterior2 = mu.posterior2,
mu.posterior1 = mu.posterior1)
cat(paste("Posterior mu0      : ", round(pos.m,4),"\n",sep=""))
cat(paste("Posterior lamda0   : ", round(pos.p,4),"\n",sep=""))
cat(paste("Posterior alpha    : ", round(pos.alpha,4),"\n",sep=""))
cat(paste("Posterior beta     : ", round(pos.beta,4),"\n",sep=""))
invisible(res)
}
a <- normalprob(y,m,p,alpha,beta)
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior))
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior), xlim =range(-2:2))
zz <- stats::qnorm(c(0.0001,0.9999), mean = m, sd = sqrt(1/p))
zz
muu <- m + zz[2]
mul <- m - zz[1]
mu <- seq(mul, muu, length.out = 1000)
mu
normalprob <- function (x, m, p, alpha, beta){
######################################################################
# prior p(mu,tau)
z <- stats::qgamma(0.9999, shape = alpha, rate = beta)
tau <- seq(0,z, length.out = 1000)
tau.prior <- stats::dgamma(tau, shape = alpha, rate = beta)
zz <- stats::qnorm(c(0.0001,0.9999), mean = m, sd = sqrt(1/p))
muu <- m + zz[2]
mul <- m - zz[1]
mu <- seq(mul, muu, length.out = 1000)
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
prior <- tau ^ (alpha - 0.5) * exp(- beta * tau) *
exp(-0.5 * tau * p * (mu - m) ^ 2)
######################################################################
#likelihood x~N(mu, tao^-1)
n <- length(x)
x_mean <- mean(x)
s_var <- 1 / n * sum((x - x_mean) ^ 2)
ss <- n * s_var
likelihood <- tau ^ (n / 2) * exp((-tau/2) *
(n * s_var + n * (x_mean-mu) ^2))
######################################################################
#posterior
pos.p <- p + n
pos.m <- (p * m + n * x_mean) / pos.p
pos.alpha <- alpha + n/2
pos.beta <- beta + 0.5 * (ss + (p * n * (x_mean - m)^2 /pos.p))
tau.posterior <- stats::dgamma(tau, pos.alpha, pos.beta)
p1 <- (mu - pos.m) ^ 2
p2 <- pos.alpha + 0.5
mu.posterior1 <- (2 * pos.beta + pos.p * p2) ^ (-p1)
mu.posterior2 <- stats::dt(mu, df = 2 * pos.alpha)
pos1 <- pos.alpha - 0.5
pos2 <- tau * pos.p * 0.5 * (mu - pos.m) ^ 2
pos3 <- tau * (beta + ss * 0.5)
pos4 <- 0.5 * tau * (p * (m ^ 2) + n * (x_mean ^2) + pos.p * (pos.m ^ 2))
posterior <- tau ^ pos1 * exp(-pos2) * exp(-pos3) * exp(-pos4)
res <- list( mu = mu,
tau = tau,
prior = prior,
mu.prior = mu.prior,
tau.prior = tau.prior,
likelihood = likelihood,
posterior = posterior,
pos.m =  pos.m,
pos.p =  pos.p,
pos.alpha = pos.alpha,
pos.beta = pos.beta,
tau.posterior = tau.posterior,
mu.posterior2 = mu.posterior2,
mu.posterior1 = mu.posterior1)
cat(paste("Posterior mu0      : ", round(pos.m,4),"\n",sep=""))
cat(paste("Posterior lamda0   : ", round(pos.p,4),"\n",sep=""))
cat(paste("Posterior alpha    : ", round(pos.alpha,4),"\n",sep=""))
cat(paste("Posterior beta     : ", round(pos.beta,4),"\n",sep=""))
invisible(res)
}
a <- normalprob(y,m,p,alpha,beta)
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior), xlim =range(-2:2))
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior))
matplot(cbind(a$mu, a$mu), cbind(a$mu.prior, a$mu.posterior2), col = 1:2)
matplot(cbind(a$tau, a$tau), cbind(a$tau.prior, a$tau.posterior2), col = 1:2)
matplot(cbind(a$tau, a$tau), cbind(a$tau.prior, a$tau.posterior2), col = 1:2)
m <- 0
p <- 1
alpha <- 1
beta <- 1
a <- normalprob(y,m,p,alpha,beta)
matplot(cbind(a$mu, a$mu), cbind(a$mu.prior, a$mu.posterior2), col = 1:2)
a$mu.prior
a$mu
muu <- m + 5
mul <- m - 5
mu <- seq(mul, muu, length.out = 1000)
mu
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
mu.prior
a$mu.prior
normalprob <- function (x, m, p, alpha, beta){
######################################################################
# prior p(mu,tau)
z <- stats::qgamma(0.9999, shape = alpha, rate = beta)
tau <- seq(0,z, length.out = 1000)
tau.prior <- stats::dgamma(tau, shape = alpha, rate = beta)
muu <- m + 5
mul <- m - 5
mu <- seq(mul, muu, length.out = 1000)
mu.prior <- (beta + p * 0.5 * (mu - m) ^ 2) ^ (- alpha - 0.5)
prior <- tau ^ (alpha - 0.5) * exp(- beta * tau) *
exp(-0.5 * tau * p * (mu - m) ^ 2)
######################################################################
#likelihood x~N(mu, tao^-1)
n <- length(x)
x_mean <- mean(x)
s_var <- 1 / n * sum((x - x_mean) ^ 2)
ss <- n * s_var
likelihood <- tau ^ (n / 2) * exp((-tau/2) *
(n * s_var + n * (x_mean-mu) ^2))
######################################################################
#posterior
pos.p <- p + n
pos.m <- (p * m + n * x_mean) / pos.p
pos.alpha <- alpha + n/2
pos.beta <- beta + 0.5 * (ss + (p * n * (x_mean - m)^2 /pos.p))
tau.posterior <- stats::dgamma(tau, pos.alpha, pos.beta)
p1 <- (mu - pos.m) ^ 2
p2 <- pos.alpha + 0.5
mu.posterior1 <- (2 * pos.beta + pos.p * p2) ^ (-p1)
mu.posterior2 <- stats::dt(mu, df = 2 * pos.alpha)
pos1 <- pos.alpha - 0.5
pos2 <- tau * pos.p * 0.5 * (mu - pos.m) ^ 2
pos3 <- tau * (beta + ss * 0.5)
pos4 <- 0.5 * tau * (p * (m ^ 2) + n * (x_mean ^2) + pos.p * (pos.m ^ 2))
posterior <- tau ^ pos1 * exp(-pos2) * exp(-pos3) * exp(-pos4)
res <- list( mu = mu,
tau = tau,
prior = prior,
mu.prior = mu.prior,
tau.prior = tau.prior,
likelihood = likelihood,
posterior = posterior,
pos.m =  pos.m,
pos.p =  pos.p,
pos.alpha = pos.alpha,
pos.beta = pos.beta,
tau.posterior = tau.posterior,
mu.posterior2 = mu.posterior2,
mu.posterior1 = mu.posterior1)
cat(paste("Posterior mu0      : ", round(pos.m,4),"\n",sep=""))
cat(paste("Posterior lamda0   : ", round(pos.p,4),"\n",sep=""))
cat(paste("Posterior alpha    : ", round(pos.alpha,4),"\n",sep=""))
cat(paste("Posterior beta     : ", round(pos.beta,4),"\n",sep=""))
invisible(res)
}
a <- normalprob(y, 0, 1, 1, 1)
a$mu.prior
matplot(cbind(a$mu, a$mu), cbind(a$mu.prior, a$mu.posterior2), col = 1:2)
matplot(cbind(a$tau, a$tau), cbind(a$tau.prior, a$tau.posterior2), col = 1:2)
matplot(cbind(a$tau, a$tau), cbind(a$tau.prior, a$tau.posterior), col = 1:2)
contour(a$mu, a$tau, outer(a$mu.posterior2,a$tau.posterior))
library(statg012)
library(statg012)
x <- rnorm(9, sd = 2)
xx <- x- mean(x) + 20
normnorm(xx, m = 25, s = sqrt(10), sigma = 2)
normnorm(xx, m = 25, p = sqrt(10), sigma = 2)
library(statg012)
normnorm(xx, m = 25, p = sqrt(10), sigma = 2)
normnorm(xx, m = 25, p = sqrt(10), sigma = 2)
normnorm(xx, m = 25, s = sqrt(10), sigma = 2)
normnorm(xx, m = 0, s = 1, alpha =1 , beta =1)
library(statg012)
normnorm(xx, m = 0, s = 1, alpha =1 , beta =1)
b <- normnorm(xx, m = 0, s = 1, alpha =1 , beta =1)
contour(b$mu, b$tau, outer(b$mu.posterior,b$tau.posterior))
contour(b$mu, b$tau, outer(b$mu.posterior,b$tau.posterior), ylim = range(0:1))
x <- rnorm(13, mean = 3, sd = 0.5)
x <- rnorm(13, mean = 2, sd = 0.5)
a <- normnorm(x, m = 3, s = 25, alpha = 12, beta = 92)
contour(a$mu, a$tau, outer(a$mu.posterior,a$tau.posterior))
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
contour(a$mu, a$tau, outer(a$mu.posterior,a$tau.posterior))
contour(a$mu, a$tau, outer(a$mu.posterior,a$tau.posterior), xlim = range(-3:3), ylim = range(0:4))
contour(a$mu, a$tau, outer(a$mu.posterior,a$tau.posterior), xlim = range(-1:1), ylim = range(0:2))
contour(a$mu, a$tau, outer(a$mu.posterior,a$tau.posterior), xlim = range(-1:1), ylim = range(0:2),main="a")
library(statg012)
library(statg012)
y <- rnorm(13, mean = 2, sd = 0.5)
exmp2 <- normnorm(y, m = 0.5, s = 1, a = 2, b = 2)
plot.normal(exmp2, which = 1)
plot.normal(exmp2, which == 1)
?lm
?plot.lm
is(plot.lm)
is(lm)
library(statg012)
plot.normal(exmp2, which = 1)
plot.normal(exmp2, which = 2)
plot.normal(exmp2, which = 3)
plot.normal(exmp2, which = 4)
exmp1 <- normnorm(xx, m = 25, s = sqrt(10), sigma = 2)
plot.normal(exmp1)
plot.normal(exmp1, leg_pos = "right", cex = 0.5)
plot.normal(exmp1, leg_pos = "right", cex = 2)
plot.normal(exmp1, leg_pos = "right", cex = 0.8)
plot.normal(exmp2, which = 1)
plot.normal(exmp2, which = 2)
plot.normal(exmp2, which = 2, col = 1:2)
library(statg012)
plot.normal(exmp2, which = 3, main = "Contour of Prior")
plot.normal(exmp2, which = 3, main = "Contour of Prior", title)
plot.normal(exmp2, which = 3, main = "Contour of Prior", title = "contour of prior")
plot.normal(exmp2, which = 3, main = "Prior Contour", ylim = range(0:3) )
library(statg012)
plot.normal(exmp2, which = 3, main = "Prior Contour", ylim = range(0:3) )
plot.normal(exmp2, which = 4, main = "Posterior Contour")
plot.normal(exmp2, which = 4, main = "Posterior Contour", ylim = range(1:4))
plot.normal(exmp2, which = 4, main = "Posterior Contour", ylim = range(1:5))
plot.normal(exmp2, which = 4, main = "Posterior Contour", xlim = range(-3:3),ylim = range(1:5))
plot.normal(exmp2, which = 3, main = "Prior Contour",
xlim = range(-3:3),ylim = range(0:3) )
library(statg012)
x <- c(2, 10)
ex <- poisgamma(x, 4, 1)
plot(ex,leg_pos = "right",cex = 1, lty = 5:6,
main = "Distributions of Example5.6")
ex <- binombeta(4, 6, 10, 3)
plot(ex, lty = 1:2, col = c(4,2))
library(statg012)
ex <- binombeta(4, 6, 10, 3)
plot(ex, lty = 1:2, col = c(4,2))
library(statg012)
ex <- binombeta(4, 6, 10, 3)
plot(ex, lty = 1:2, col = c(4,2))
library(statg012)
ex <- binombeta(4, 6, 10, 3)
plot(ex, lty = 1:2, col = c(4,2))
x <- c(2, 10)
ex <- poisgamma(x, 4, 1)
plot(ex, lty = 1:2, col = c(4,2))
library(statg012)
plot(exmp2, which = 1)
x <- rnorm(13, mean = 2, sd = 0.5)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
summary(a)
a$model
length(a)
library(statg012)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
summary(a)
library(statg012)
summary(a)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
summary(a)
library(statg012)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
summary(a)
b <- summary(a)
b
pos.m <- a$pos.m
pos.p <- a$pos.p
pos.alpha <- a$pos.alpha
pos.beta <- a$pos.beta
x.var <- pos.beta /(pos.p * (pos.alpha - 1))
(pos.alpha - 1) * pos.p
library(statg012)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
summary(a)
library(statg012)
a <- normnorm(x, m = 0, s = 1, alpha = 1, beta = 1)
library(statg012)
summary(a)
library(statg012)
devtools::check()
devtools::check()
library(statg012)
browseVignettes().
browseVignettes()
devtools::use_vignette("my-vignette")
browseVignettes("revdbayes")
library(statg012)
library(statg012)
library(statg012)
?statg012
dnbinom(10,2,0.5)
?binombeta
library(statg012)
binombeta(1,1,c(4,5),10)
?dnbinom
library(statg012)
nbinombeta(1,1,2,10)
library(statg012)
nbinombeta(1,1,2,10)
pos.beta <- beta + r
library(statg012)
nbinombeta(1,1,2,10)
library(statg012)
a <- nbinombeta(1,2,10,3)
a <- nbinombeta(1,1,10,3)
a <- nbinombeta(1,1,2,5)
dnbinom(10,3,prob = seq(0,1))
dnbinom(10,3,prob = seq(0,1,0.001))
dnbinom(10,3,0)
library(statg012)
library(statg012)
library(statg012)
ex <- nbinombeta(4, 6, 3, 2)
summary(ex)
library(statg012)
plot(ex)
plot(ex,lty = 2:3, col = c(5,2))
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
library(statg012)
