{
    "collab_server" : "",
    "contents" : "#' Binomial sampling distribution with a beta distribution of prior\n#'\n#'Define the posterior distribution function for \\eqn{\\pi ( \\theta | r )}, with\n#'a beta prior distribution \\eqn{\\pi ( \\theta; a, b )} and a binomial sampling\n#'distribution \\eqn{p ( r | \\theta )}.\n#'\n#'@param alpha parameter for the beta distribution ( \\eqn{\\ge 0} ).\n#'@param beta parameter for the beta distribution ( \\eqn{\\ge 0} ).\n#'@param n the number of trials in binomial distribution.\n#'@param r the number of successes in n trials.\n#'@param \\eqn{\\theta} the range of the probability of success.\n#'@return An object of class \"\\code{binbeta}\" is returned.\n#'\\item{prior}{the prior distribution, i.e.\n#' the \\eqn{beta(\\alpha,\\beta)} distribution} \\item{likelihood}{the likelihood\n#' function of r given \\eqn{\\theta}, i.e. the\n#' \\eqn{binomial(n,r)} distribution} \\item{posterior}{the\n#' posterior distribution of \\eqn{\\theta} given r, i.e. the\n#' \\eqn{beta(\\alpha+r, \\beta+n-r)} distribution} \\item{theta}{the\n#' range of the probability of success} \\item{pri.alpha}{the\n#' alpha parameter for the beta distribution of prior} \\item{pri.beta}{the\n#' beta parameter for the beta distribution of prior} \\item{pos.alpha}{the\n#' alpha parameter for the beta distribution of posterior} \\item{pos.beta}{the\n#' beta parameter for the beta distribution of posterior}\n#'@seealso \\code{\\link{summary.binbeta}} will return summararies of prior\n#'and posterior distribution.\n#'@examples\n#'## simplest one with 3 successes in 10 trials and a uniform beta(1,1) prior\n#'binbeta(6, 2)\n#'\n#'## example 3.6 : 3 successes in 10 trials and a beta(4,6) prior\n#'binbeta(4, 6, 10, 3)\n#'\n#'## 3 successes in 10 trials and a beta(4,6) prior, do not show the plot\n#'binbeta(4, 6, 10, 3, plot = FALSE)\n#'\n#'@export\n\n  binbeta <- function( alpha, beta, n, r, theta = seq(0,1,0.001)) {\n  #############################################################################\n  #alpha, beta: are parameters of beta distribution of prior ( >0)\n  #theta: the range of the probability of success\n  #n: no. of  binomial trials\n  #r: no. of successes in n trials (0<= r<= n)\n\n  if (n < 0) {\n   stop(\"The number of trials n should not smaller than zero\")\n  }\n\n  if (n < r) {\n    stop(\"The number of successes r should not larger than trials n\")\n  }\n\n  if (alpha <= 0 | beta <= 0) {\n    stop(\"The parameters of beta distribution should be larger than zero\")\n  }\n  #############################################################################\n  # formula: slides 2 example 3.6 (p.45)\n\n  prior <- stats::dbeta(theta, alpha, beta, log = FALSE)\n  likelihood <- stats::dbinom(r, n, prob = theta, log = FALSE)\n  pos.alpha <- alpha + r\n  pos.beta <- beta + n-r\n  posterior <- stats::dbeta(theta, pos.alpha, pos.beta)\n\n ##############################################################################\n # results\n  res <- list(    prior = prior,\n                  likelihood = likelihood,\n                  posterior = posterior,\n                  theta = theta,\n                  pri.alpha = alpha,\n                  pri.beta = beta,\n                  pos.alpha = pos.alpha,\n                  pos.beta = pos.beta)\n\n  class(res) <- \"binbeta\"\n  invisible(res)\n  }\n  #############################################################################\n  #summary of the statistics\n\n#' Summarizing binomial sampling distribution with a beta distribution of\n#' prior\n#'\n#' A function used to produce summaries of prior and poesterior distribution,\n#' based on binomial sampling distribution with a beta distribution of prior.\n#'\n#' @param objects an object of class \"\\code{g12binbeta}\", usually, a result of a call\n#' to \\code{\\link{binbeta}}.\n#' @param ... further arguments from other methods\n#' @return the function \\code{summary.binbeta} returns a list of summary\n#' statistics of prior and posterior distribution, repectively.\n#' @export\n   summary.binbeta <- function(objects, ...) {\n    res <- objects\n    ##statistics of prior function\n    pri.alpha <- res$pri.alpha\n    pri.beta <- res$pri.beta\n    pri.mean <- pri.alpha / (pri.alpha+pri.beta)\n    pri.var <- (pri.alpha * pri.beta) /\n      ((pri.alpha + pri.beta) ^ 2 * (pri.alpha + pri.beta +1))\n    pri.std <- sqrt(pri.var)\n    pri.mode <- (pri.alpha - 1) / (pri.alpha + pri.beta - 2)\n    prob <- c(0.0500, 0.2500, 0.5000, 0.7500, 0.9500)\n    pri.qtl <- stats::qbeta(prob, pri.alpha, pri.beta)\n\n    cat(paste(\"Prior Mean           : \",round(pri.mean, 5), \"\\n\"))\n    cat(paste(\"Prior Variance       : \",round(pri.var, 5), \"\\n\"))\n    cat(paste(\"Prior Std. Deviation : \",round(pri.std, 5), \"\\n\"))\n    cat(paste(\"Prior Mode           : \",round(pri.mode, 5), \"\\n\"))\n    cat(\"quantiles:\", round(prob, 5), \"\\n\")\n    cat(\"\\t\", round(pri.qtl, 5), \"\\n\")\n\n    ##statistics of posterior function\n    pos.alpha <- res$pos.alpha\n    pos.beta <- res$pos.beta\n    pos.mean <- pos.alpha/ (pos.alpha + pos.beta)\n    pos.var <- (pos.alpha * pos.beta) /\n      ((pos.alpha + pos.beta) ^ 2 * (pos.alpha + pos.beta +1))\n    pos.std <- sqrt(pos.var)\n    pos.mode <-\n      if (pos.alpha > 1 & pos.beta > 1) {\n        pos.mode <- (pos.alpha - 1) / (pos.alpha + pos.beta - 2)\n      } else {\n        \"The mode only can be calculated when both parameters are larger than 1\"\n      }\n    prob <- c(0.0500, 0.2500, 0.5000, 0.7500, 0.9500)\n    pos.qtl <- stats::qbeta(prob, pos.alpha, pos.beta)\n\n    cat(paste(\"Posterior Mean           : \",round(pos.mean, 5), \"\\n\"))\n    cat(paste(\"Posterior Variance       : \",round(pos.var, 5), \"\\n\"))\n    cat(paste(\"Posterior Std. Deviation : \",round(pos.std, 5), \"\\n\"))\n    cat(paste(\"Posterior Mode           : \",round(pos.mode, 5), \"\\n\"))\n    cat(\"quantiles:\", round(prob, 5), \"\\n\")\n    cat(\"\\t\", round(pos.qtl, 5), \"\\n\")\n ######################################################################\n\n    results <- list (prior.variance = pri.var,\n                     prior.std.deviation = pri.std,\n                     prior.mode = pri.mode,\n                     prior.quantiles = pri.qtl,\n                     posteror.mean = pos.mean,\n                     posteror.variance = pos.var,\n                     posteror.std.deviation = pos.std,\n                     posteror.mode = pos.mode,\n                     posteror.quantiles = pos.qtl)\n    class(results) <- \"summary.g12binbeta\"\n    invisible(results)\n  }\n\n\n  #############################################################################\n  # plots\n\n  #if (plot) {\n  # graphics::plot(posterior ~ theta, type = \"l\", lwd = 3,\n  #                 xlab = expression(paste(theta,\n  #                                        \": The Probability of Success\")),\n  #                ylab = \"Probalbility Density Function\",\n  #                main = \"The Prior, Likelihood and Posterior Distribution\",\n  #                col = \"red\")\n  # lines(prior ~ theta, type = \"l\", lwd = 3, col = \"blue\")\n  # lines(likelihood ~ theta,type = \"l\", lwd = 3, col = \"green\" )\n\n  # legend(\"right\", legend = c(\"Posterior Dist.\",\n   #                            \"Prior Dist. \",\n    #                           \"Likelihood Dist.\"),\n   #        bty = \"o\",\n   #        cex = 1,\n  #         lty = c(1, 1, 1),\n  #         lwd = c(3, 3, 3),\n   #        col = c(\"red\",\"blue\", \"green\"))\n # }\n\n",
    "created" : 1497122915389.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2534388319",
    "id" : "CAFFB5CD",
    "lastKnownWriteTime" : 1498250780,
    "last_content_update" : 1498250780119,
    "path" : "~/statg012/R/binbeta.R",
    "project_path" : "R/binbeta.R",
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}